(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1647"],{"9Pcu":function(t,e,a){"use strict";var i={props:{thead:{type:Array,required:!0},list:{type:Array,required:!0,default:function(){return[]}},actions:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1}},computed:{},created:function(){},methods:{}},n=(a("SG8p"),a("KHd+")),l=Object(n.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"border-radius":"6px","margin-top":"15px"},attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[t._l(t.thead,function(e){return a("el-table-column",{key:e.label,attrs:{sortable:e.sort,label:e.label,width:e.width,prop:e.value,align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e.isImage?["Array"==={}.toString.call(i.row[e.value]).slice(8,-1)?a("el-carousel",{attrs:{height:e.styleObject.height,autoplay:!1,"indicator-position":"none",type:"card"}},t._l(i.row[e.value],function(t,i){return a("el-carousel-item",{key:i},[a("img",{style:e.styleObject,attrs:{src:t,alt:"暂无图片"}})])})):a("img",{style:e.styleObject,attrs:{src:i.row[e.value],alt:"暂无图片"}})]:e.isTag?t._l(i.row[e.value],function(e,i){return a("span",{key:i,staticClass:"el-tag el-tag--info el-tag--small",staticStyle:{margin:"4px"}},[a("span",{staticClass:"el-select__tags-text"},[t._v("\n            "+t._s(e)+"\n          ")])])}):[t._v("\n        "+t._s(i.row[e.value])+"\n      ")]]}}])})}),t._v(" "),0!==t.list.length&&0!==t.actions.length?a("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.actions,function(i,n){return a("el-button",{key:i.value,style:{margin:t.actions.length>2?"5px":"0 0 0 10px"},attrs:{type:i.type,size:"mini"},on:{click:function(t){i.click(e.row,e.$index)}}},[t._v(t._s(i.value)+"\n      ")])})}}])}):t._e()],2)},[],!1,null,"5215e21c",null);l.options.__file="index.vue";e.a=l.exports},Cddm:function(t,e,a){},FyfS:function(t,e,a){t.exports={default:a("Rp86"),__esModule:!0}},Rp86:function(t,e,a){a("bBy9"),a("FlQf"),t.exports=a("fXsU")},SG8p:function(t,e,a){"use strict";var i=a("TqJv");a.n(i).a},TqJv:function(t,e,a){},Xb6M:function(t,e,a){"use strict";a.r(e);var i=a("FyfS"),n=a.n(i),l=a("jo6Y"),s=a.n(l),o=a("P2sY"),r=a.n(o),c=a("QbLZ"),u=a.n(c),d=a("9Pcu"),p=a("L2JU"),m=a("qwx8"),f={components:{Table:d.a},filters:{toChinese:function(t){return{1:"选项一",2:"选项二",3:"选项三",4:"四",5:"五"}[t]}},data:function(){return{headers:{},name:"",list:[],listLoading:!0,total:0,thead:[],listQuery:{userId:null,index:1,pageSize:10,orderType:1},temp:{},dialogStatus:"",dialogFormVisible:!1,dialogImageUrl:"",dialogVisible:!1,images:[],rules:{title:[{type:"string",required:!0,message:"问题是必须的",trigger:"blur"}],content:[{type:"string",required:!0,message:"选项内容是必须的",trigger:"blur"}],score:[{type:"number",required:!0,message:"分数是必须的",trigger:"blur"}],"moment.content":[{type:"string",required:!0,message:"内容是必须的",trigger:"blur"}]},actions:[{type:"primary",value:"编辑",click:this.handleUpdate},{type:"danger",value:"删除",click:this.handleDelete}]}},created:function(){this.getUserId(),this.fetchData()},methods:u()({},Object(p.b)(["token"]),{getUserId:function(){var t=this.$route.query,e=t.userId,a=t.name;this.listQuery.userId=parseInt(e),this.name=a,this.headers={token:this.token()}},dataFilter:function(t){return"Array"==={}.toString.call(t).slice(8,-1)?t.forEach(function(t){t.answers.forEach(function(e,a){t["content"+e.sequence]=e.content,t["score"+e.sequence]=e.score})}):t.answers.forEach(function(e,a){t["content"+(a+1)]=e.content,t["score"+(a+1)]=e.score}),t},fetchData:function(){var t=this;Object(m.c)(this.listQuery).then(function(e){var a=e.data,i=a.items,n=a.totalCount,l=t.dataFilter(i);console.log(l),t.getHead(l),t.list=l,t.total=parseInt(n),t.listLoading=!1})},getHead:function(t){var e=[];for(var a in t[0]){var i={sort:!1};switch(a){case"title":i.label="问题",i.value=a,e[0]=i;break;case"content1":i.label="答案一",i.value=a,e[1]=i;break;case"score1":i.label="分数一",i.value=a,i.width="76px",e[2]=i;break;case"content2":i.label="答案二",i.value=a,e[3]=i;break;case"score2":i.label="分数二",i.value=a,i.width="76px",e[4]=i;break;case"content3":i.label="答案三",i.value=a,e[5]=i;break;case"score3":i.label="分数三",i.value=a,i.width="76px",e[6]=i;break;default:continue}}this.thead=e},handleCurrentChange:function(t){this.listQuery.index=t,this.fetchData()},handleFilter:function(){this.listQuery.index=1,this.fetchData()},uploadImgFilter:function(t){var e=[];t.forEach(function(t,a){var i={};i.imageUrl=t.response.data,i.sequence=a+1,e.push(i)}),this.images=e},handleImgSuccess:function(t,e,a){console.log(t,e,a),this.uploadImgFilter(a)},handleImgError:function(t){console.log("上传图片失败",t),this.$message({type:"error",message:"上传图片失败",duration:1500})},handleImgCb:function(t){console.log("查看图片成功",t),this.dialogImageUrl=t.url,this.dialogVisible=!0},handleImgRemove:function(t,e){console.log("移除上传图片成功",e),this.uploadImgFilter(e)},handleImgLimit:function(){this.$message({message:"最多上传6张图片",type:"error",duration:1800})},upLoadImgCancel:function(){this.dialogFormVisible=!this.dialogFormVisible,this.$refs.myUpload&&this.$refs.myUpload.clearFiles()},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="添加",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleUpdate:function(t){var e=this;console.log(t),this.temp=r()({},t),this.dialogStatus="编辑",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleDelete:function(t){var e=this;console.log("要删除的id",t.id),Object(m.b)({id:t.id}).then(function(){var a=e.list.indexOf(t);e.list.splice(a,1),e.$notify({title:"成功",message:"用户删除成功",type:"success",duration:1500})})},resetTemp:function(){this.temp={user:{id:this.listQuery.userId},title:"",answers:[{content:"",score:null},{content:"",score:null},{content:"",score:null}],levelUp:!1,longPause:!1,momentId:"",moment:{user:{id:this.listQuery.userId},content:"",type:0}}},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=null,i=t.temp,n=i.levelUp,l=i.moment,o=s()(i,["levelUp","moment"]);n?(0!==t.images.length&&(l.images=t.images,l.type=1),a=r()({},u()({levelUp:n,moment:l},o))):a=r()({},u()({levelUp:n},o)),console.log("createData",a),Object(m.a)(a).then(function(){var e=t.dataFilter(a);t.list.unshift(e),t.dialogFormVisible=!1,t.$notify({title:"成功",message:"创建成功",type:"success",duration:1500})})}})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=t.temp,i={id:a.id,user:a.user,title:a.title,answers:a.answers,longPause:a.longPause,momentId:a.momentId};console.log("updateData",i),Object(m.e)(i).then(function(){var e=t.dataFilter(i),a=!0,l=!1,s=void 0;try{for(var o,r=n()(t.list);!(a=(o=r.next()).done);a=!0){var c=o.value;if(c.id===e.id){var u=t.list.indexOf(c);t.list.splice(u,1,e);break}}}catch(t){l=!0,s=t}finally{try{!a&&r.return&&r.return()}finally{if(l)throw s}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:1500})})}})}})},g=(a("XrFk"),a("KHd+")),h=Object(g.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inner"},[a("span",{staticClass:"title"},[t._v(t._s(t.name)+" 的剧本")]),t._v(" "),a("div",{staticClass:"app-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("新增数据")]),t._v(" "),a("Table",{attrs:{thead:t.thead,list:t.list||[],listLoading:t.listLoading,actions:t.actions}}),t._v(" "),a("div",{staticClass:"pagination-container",staticStyle:{"margin-top":"20px"},attrs:{align:"right"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper",total:t.total,"current-page":t.listQuery.index,"page-size":t.listQuery.pageSize},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"dialog"},[a("el-form",{ref:"dataForm",staticStyle:{"min-width":"450px","max-width":"1000px"},attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"110px"}},[a("el-form-item",{staticClass:"title",attrs:{label:"问题",prop:"title"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入问题"},model:{value:t.temp.title,callback:function(e){t.$set(t.temp,"title","string"==typeof e?e.trim():e)},expression:"temp.title"}})],1),t._v(" "),a("el-form-item",{staticClass:"longPause",attrs:{label:"长停顿"}},[a("el-checkbox",{model:{value:t.temp.longPause,callback:function(e){t.$set(t.temp,"longPause",e)},expression:"temp.longPause"}},[t._v(t._s(t.temp.longPause?"是":"否"))])],1),t._v(" "),t._l(t.temp.answers,function(e,i){return a("div",{key:i,staticClass:"contentAry"},[a("el-form-item",{staticClass:"content",attrs:{rules:t.rules.content,prop:"answers["+i+"].content",label:t._f("toChinese")(i+1)}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入选项内容"},model:{value:e.content,callback:function(a){t.$set(e,"content","string"==typeof a?a.trim():a)},expression:"answer.content"}})],1),t._v(" "),a("el-form-item",{staticClass:"score",attrs:{label:"选项得分",rules:t.rules.score,prop:"answers["+i+"].score"}},[a("el-input",{staticStyle:{width:"65px"},model:{value:e.score,callback:function(a){t.$set(e,"score",t._n("string"==typeof a?a.trim():a))},expression:"answer.score"}})],1)],1)}),t._v(" "),"添加"===t.dialogStatus?[a("el-form-item",{staticStyle:{"margin-bottom":"6px"},attrs:{label:"发布朋友圈"}},[a("el-checkbox",{staticClass:"friend",model:{value:t.temp.levelUp,callback:function(e){t.$set(t.temp,"levelUp",e)},expression:"temp.levelUp"}},[t._v(t._s(t.temp.levelUp?"是":"否"))])],1),t._v(" "),t.temp.levelUp?[a("el-form-item",{attrs:{label:"内容",prop:"moment.content"}},[a("el-input",{attrs:{autosize:{minRows:3,maxRows:4},type:"textarea",placeholder:"请输要发布朋友圈的内容"},model:{value:t.temp.moment.content,callback:function(e){t.$set(t.temp.moment,"content","string"==typeof e?e.trim():e)},expression:"temp.moment.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图片"}},[a("el-upload",{ref:"myUpload",attrs:{action:"https://luna.ajimiyou.com/luna/image/upload",headers:t.headers,"list-type":"picture-card",limit:6,"on-success":t.handleImgSuccess,"on-error":t.handleImgError,"on-preview":t.handleImgCb,"on-remove":t.handleImgRemove,"on-exceed":t.handleImgLimit}},[a("i",{staticClass:"el-icon-plus"})])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,"append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:"暂无图片"}})])]:t._e()]:t._e()],2),t._v(" "),a("div",{staticClass:"dialog-footer clearfix",attrs:{slot:"footer"},slot:"footer"},["编辑"===t.dialogStatus?[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!t.dialogFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:t.updateData}},[t._v("保存")])]:[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:t.upLoadImgCancel}},[t._v("取消")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:t.createData}},[t._v("添加")])]],2)],1)])],1)])},[],!1,null,"26f56b44",null);h.options.__file="question.vue";e.default=h.exports},XrFk:function(t,e,a){"use strict";var i=a("Cddm");a.n(i).a},fXsU:function(t,e,a){var i=a("5K7Z"),n=a("fNZA");t.exports=a("WEpk").getIterator=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},igbY:function(t,e,a){"use strict";e.a={host:"https://api.ajimiyou.com/yanxi/admin"}},jo6Y:function(t,e,a){"use strict";e.__esModule=!0,e.default=function(t,e){var a={};for(var i in t)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}},qwx8:function(t,e,a){"use strict";a.d(e,"d",function(){return l}),a.d(e,"c",function(){return s}),a.d(e,"a",function(){return o}),a.d(e,"e",function(){return r}),a.d(e,"b",function(){return c});var i=a("t3Un"),n=a("igbY");function l(t){return Object(i.a)({url:"/u/roles",method:"post",proxy:n.a,data:t})}function s(t){return Object(i.a)({url:"/q/list",method:"post",proxy:n.a,data:t})}function o(t){return Object(i.a)({url:"/q/add",method:"post",proxy:n.a,data:t})}function r(t){return Object(i.a)({url:"/q/saveOrUpdate",method:"post",proxy:n.a,data:t})}function c(t){return Object(i.a)({url:"/q/delete",method:"post",proxy:n.a,data:t})}}}]);