(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2091"],{"2QOn":function(t,e,i){},"9Pcu":function(t,e,i){"use strict";var a={props:{thead:{type:Array,required:!0},list:{type:Array,required:!0,default:function(){return[]}},actions:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1}},computed:{},created:function(){},methods:{}},n=(i("SG8p"),i("KHd+")),s=Object(n.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"border-radius":"6px","margin-top":"15px"},attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[t._l(t.thead,function(e){return i("el-table-column",{key:e.label,attrs:{sortable:e.sort,label:e.label,width:e.width,prop:e.value,align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e.isImage?["Array"==={}.toString.call(a.row[e.value]).slice(8,-1)?i("el-carousel",{attrs:{height:e.styleObject.height,autoplay:!1,"indicator-position":"none",type:"card"}},t._l(a.row[e.value],function(t,a){return i("el-carousel-item",{key:a},[i("img",{style:e.styleObject,attrs:{src:t,alt:"暂无图片"}})])})):i("img",{style:e.styleObject,attrs:{src:a.row[e.value],alt:"暂无图片"}})]:e.isTag?t._l(a.row[e.value],function(e,a){return i("span",{key:a,staticClass:"el-tag el-tag--info el-tag--small",staticStyle:{margin:"4px"}},[i("span",{staticClass:"el-select__tags-text"},[t._v("\n            "+t._s(e)+"\n          ")])])}):[t._v("\n        "+t._s(a.row[e.value])+"\n      ")]]}}])})}),t._v(" "),0!==t.list.length&&0!==t.actions.length?i("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.actions,function(a,n){return i("el-button",{key:a.value,style:{margin:t.actions.length>2?"5px":"0 0 0 10px"},attrs:{type:a.type,size:"mini"},on:{click:function(t){a.click(e.row,e.$index)}}},[t._v(t._s(a.value)+"\n      ")])})}}])}):t._e()],2)},[],!1,null,"5215e21c",null);s.options.__file="index.vue";e.a=s.exports},"9TPh":function(t,e,i){"use strict";var a=i("QbLZ"),n=i.n(a),s=i("vDqi"),l=i.n(s),r=(i("EVdn"),i("XJYT")),o=(i("X4fA"),i("L2JU")),c={props:{number:{type:Number,required:!0},imgNum:{type:Number,default:1},imgWidth:{type:Number,default:160},imgHeight:{type:Number,default:100},imgs:{type:[Array,String]},imageSrc:{type:String}},model:{prop:"imgs",event:"cc"},data:function(){return{type:1}},computed:{imageAry:function(){return void 0===this.imageSrc?"Array"==={}.toString.call(this.imgs).slice(8,-1)?(this.type=2,this.imgs):(this.type=1,[this.imgs]):(this.type=3,this.imgs)}},methods:n()({},Object(o.b)(["token"]),{fileChange:function(t,e){var i=this,a=t.target.files[0];if(console.log(a.type),a&&-1!==["image/jpeg","image/png","image/gif","video/mp3","video/mp4"].indexOf(a.type)){var n={target:"#upload"+this.number+e,background:"white",customClass:"imgMask"},s=r.Loading.service(n),o=new FormData;o.append("file",a);var c={headers:{token:this.token()}};l.a.post("https://luna.ajimiyou.com/luna/image/upload",o,c).then(function(t){console.log("响应结果",t.data);var a=t.data.data,n=a;2===i.type&&(i.imgs[e]=a,n=i.imgs.filter(function(t){return null!=t})),i.$emit("cc",n),s.close()}).catch(function(t){console.log("错误结果",t),i.$message({message:"出错了！*>﹏<* ~ 请重新上传",type:"error",duration:1800}),s.close()})}else this.$message({message:"仅支持jpeg,png,gif,mp3,mp4格式的文件",type:"error",duration:1800})},handleDelete:function(t){console.log("删除的图片",t);var e="";2===this.type&&(this.imgs[t]=null,e=this.imgs.filter(function(t){return null!=t})),this.$emit("cc",e)}})},u=(i("iZ8v"),i("KHd+")),m=Object(u.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"imageLoad clearfix"},t._l(t.imgNum,function(e,a){return i("div",{key:a,staticClass:"load-inner",style:{width:t.imgWidth+"px",height:t.imgHeight+"px"}},[1===t.type||2===t.type?[null==t.imageAry[a]||""==t.imageAry[a]?[i("div",{style:{height:t.imgHeight+"px"},attrs:{id:"upload"+t.number+a}},[i("i",{staticClass:"load-icon el-icon-plus"}),t._v(" "),i("input",{staticClass:"load-file",attrs:{type:"file",name:"image"},on:{change:function(e){t.fileChange(e,a)}}})])]:[i("div",{staticClass:"load-img"},[i("label",{staticClass:"delete-label"},[i("i",{staticClass:"delete el-icon-close",on:{click:function(e){t.handleDelete(a)}}})]),t._v(" "),i("img",{attrs:{src:t.imageAry[a],alt:"暂无图片"}})])]]:t._e()],2)}))},[],!1,null,"01b5e87c",null);m.options.__file="index.vue";e.a=m.exports},JndT:function(t,e,i){},SG8p:function(t,e,i){"use strict";var a=i("TqJv");i.n(a).a},TqJv:function(t,e,i){},XSQ0:function(t,e,i){"use strict";var a=i("JndT");i.n(a).a},"gDS+":function(t,e,i){t.exports={default:i("oh+g"),__esModule:!0}},iZ8v:function(t,e,i){"use strict";var a=i("2QOn");i.n(a).a},jo6Y:function(t,e,i){"use strict";e.__esModule=!0,e.default=function(t,e){var i={};for(var a in t)e.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}},"oh+g":function(t,e,i){var a=i("WEpk"),n=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return n.stringify.apply(n,arguments)}},z8Cl:function(t,e,i){"use strict";i.r(e);var a=i("FyfS"),n=i.n(a),s=i("jo6Y"),l=i.n(s),r=i("P2sY"),o=i.n(r),c=i("gDS+"),u=i.n(c),m=i("9Pcu"),d=i("9TPh"),p=i("t3Un");function g(t){return Object(p.a)({url:"/workStats",method:"post",proxy:{host:"https://api.ajimiyou.com/maker"},data:t})}var f={components:{Table:m.a,Dropzone:d.a},data:function(){return{list:[],listLoading:!0,loading:!1,total:0,totalPage:0,thead:[],listQuery:{index:1,pageSize:10,keyword:""},actions:[{type:"primary",value:"查看",click:this.handleUpdate}],temp:{},dialogStatus:"",dialogFormVisible:!1,rules:{name:[{type:"string",required:!0,message:"主题是必须的",trigger:"blur"}],summary:[{type:"string",required:!0,message:"简介是必须的",trigger:"blur"}],des:[{type:"string",required:!0,message:"详细介绍是必须的",trigger:"blur"}]},reason:""}},created:function(){this.fetchData()},methods:{dealData:function(t){return(t=t||[]).forEach(function(t){var e=t.id,i=t.images;if(t.id=parseInt(e),i){var a=[];i.forEach(function(t){a.push(t.image)}),t.imgs=a}t.rate=t.rate?t.rate:9.8}),t},fetchData:function(){var t=this;this.listLoading=!0,function(t){return Object(p.a)({url:"/review",method:"get",parmas:t})}(this.listQuery).then(function(e){var i=e.data,a=i.items,n=i.total,s=i.totalPage;console.log(a);var l=t.dealData(a);t.getHead(l),t.list=l,t.totalPage=s,t.total=parseInt(n),t.listLoading=!1})},getHead:function(t){var e=[];for(var i in t[0]){var a={sort:!1};switch(i){case"id":a.label="id",a.sort=!0,a.value=i,a.width="60",e[0]=a;break;case"name":a.label="标题",a.value=i,e[1]=a,a.width="106";break;case"coverImage":a.label="封面图",a.value=i,a.isImage=!0,a.width="100",a.styleObject={width:"80px",height:"50px"},e[2]=a;break;case"summary":a.label="简介",a.value=i,a.width="190",e[3]=a;break;case"imgs":a.label="详情轮播图",a.value=i,a.isImage=!0,e[4]=a,a.styleObject={width:"130px",height:"90px"};break;case"icon":a.label="icon",a.value=i,e[5]=a,a.isImage=!0,a.width="68",a.styleObject={width:"50px",height:"50px"};break;default:continue}}this.thead=e},handleCurrentChange:function(t){this.listQuery.index=t,this.fetchData()},handleFilter:function(){this.listQuery.index=1,this.fetchData()},handleUpdate:function(t){var e=this;console.log(t);var i=JSON.parse(u()(t)),a=i.id,n=i.name,s=i.summary,l=i.des,r=i.icon,c=i.imgs,m=i.coverImage;this.temp=o()({},{id:a,name:n,summary:s,des:l,icon:r,imgs:c,coverImage:m}),this.dialogStatus="编辑",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleDelete:function(t){var e=this;console.log("要删除的id",t.id),deleteDodaData(t.id).then(function(){var i=e.list.indexOf(t);e.list.splice(i,1),e.total=e.total-1,e.$notify({title:"成功",message:"用户删除成功",type:"success",duration:1500})})},dealImgs:function(){var t=this.temp,e=t.imgs,i=l()(t,["imgs"]),a=[];return e.forEach(function(t,e){var i={};i.image=t,a.push(i)}),o()({},{images:a},i)},result:function(t){var e=this;this.loading||this.$refs.dataForm.validate(function(i){if(i){e.loading=!0;var a=e.dealImgs();a.state=t;var s={id:a.id,stats:t};3===t&&(s.failureReason=e.reason),console.log("pass",a),function(t){return Object(p.a)({url:"/review/save",method:"post",data:t})}(a).then(function(t){console.log(t);var i=t.data;s.gameId=i.id,g(s).then().catch(function(t){g(s)});var l=!0,r=!1,o=void 0;try{for(var c,u=n()(e.list);!(l=(c=u.next()).done);l=!0){var m=c.value;if(m.id===a.id){var d=e.list.indexOf(m);e.list.splice(d,1),e.total=e.total-1;break}}}catch(t){r=!0,o=t}finally{try{!l&&u.return&&u.return()}finally{if(r)throw o}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"审核成功",type:"success",onClose:function(){e.loading=!1}})}).catch(function(){e.$notify({title:"失败",message:"审核失败,请重试",type:"error",duration:1e3,onClose:function(){e.loading=!1}})})}})}}},h=(i("XSQ0"),i("KHd+")),v=Object(h.a)(f,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"inner"},[i("span",{staticClass:"title"},[t._v("哆哒作品审核")]),t._v(" "),i("div",{staticClass:"app-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"400px","margin-right":"20px"},attrs:{placeholder:"请输入要搜索的内容"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",t._n(e))},expression:"listQuery.keyword"}}),t._v(" "),i("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),i("Table",{attrs:{thead:t.thead,list:t.list||[],listLoading:t.listLoading,actions:t.actions}}),t._v(" "),i("div",{staticClass:"pagination-container",staticStyle:{"margin-top":"20px"},attrs:{align:"right"}},[i("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper",total:t.total,"current-page":t.listQuery.index,"page-size":t.listQuery.pageSize},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("div",{staticClass:"dialog"},[i("el-form",{ref:"dataForm",staticStyle:{"min-width":"450px","max-width":"1000px"},attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"90px"}},[i("el-form-item",{staticClass:"name",attrs:{label:"标题",prop:"name"}},[i("el-input",{model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name","string"==typeof e?e.trim():e)},expression:"temp.name"}})],1),t._v(" "),i("el-form-item",{staticClass:"icon",attrs:{label:"icon","label-width":"50px"}},[i("Dropzone",{attrs:{number:1,imgWidth:70,imgHeight:70},model:{value:t.temp.icon,callback:function(e){t.$set(t.temp,"icon",e)},expression:"temp.icon"}})],1),t._v(" "),i("el-form-item",{staticClass:"summary",attrs:{label:"简介",prop:"summary"}},[i("el-input",{staticStyle:{"max-width":"700px"},model:{value:t.temp.summary,callback:function(e){t.$set(t.temp,"summary","string"==typeof e?e.trim():e)},expression:"temp.summary"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"932px"},attrs:{label:"详细介绍",prop:"des"}},[i("el-input",{attrs:{autosize:{minRows:3,maxRows:4},type:"textarea",placeholder:"请输入详细介绍"},model:{value:t.temp.des,callback:function(e){t.$set(t.temp,"des","string"==typeof e?e.trim():e)},expression:"temp.des"}})],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"轮播图"}},[i("Dropzone",{attrs:{number:2,imgNum:5,imgWidth:162,imgHeight:120},model:{value:t.temp.imgs,callback:function(e){t.$set(t.temp,"imgs",e)},expression:"temp.imgs"}})],1),t._v(" "),i("el-form-item",{staticClass:"coverImage",attrs:{label:"封面图"}},[i("Dropzone",{attrs:{number:0,imgWidth:180,imgHeight:120},model:{value:t.temp.coverImage,callback:function(e){t.$set(t.temp,"coverImage",e)},expression:"temp.coverImage"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"未通过原因"}},[i("el-input",{attrs:{autosize:{minRows:3,maxRows:4},type:"textarea",placeholder:"请输入详细介绍"},model:{value:t.reason,callback:function(e){t.reason="string"==typeof e?e.trim():e},expression:"reason"}})],1)],1),t._v(" "),i("div",{staticClass:"footer clearfix",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!t.dialogFormVisible}}},[t._v("取消")]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:function(e){t.result(2)}}},[t._v("通过")]),t._v(" "),i("el-button",{staticStyle:{display:"block",margin:"0 125px"},attrs:{type:"danger"},on:{click:function(e){t.result(3)}}},[t._v("未通过")])],1)],1)])],1)])},[],!1,null,null,null);v.options.__file="dodaCheck.vue";e.default=v.exports}}]);