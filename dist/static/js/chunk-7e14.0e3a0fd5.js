(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e14"],{"+HKF":function(t,e,a){"use strict";var i=a("4d7F"),n=a.n(i),o=a("QbLZ"),l=a.n(o),s=a("YEIV"),r=a.n(s),c=a("vDqi"),u=a.n(c),d=a("XJYT"),m=(a("X4fA"),a("L2JU")),p={props:{number:{type:Number,required:!0},imgNum:{type:Number,default:1},imgWidth:{type:Number,default:160},imgHeight:{type:Number,default:100},imgs:{type:[Array,String]},imgSize:{type:String},fieldName:{type:String,default:"src"},uploadType:{type:Array,default:function(){return["jpeg","png","gif","mp3"]}}},model:{prop:"imgs",event:"cc"},data:function(){return{type:1}},computed:{images:function(){var t=this.imgs;if("Array"==={}.toString.call(this.imgs).slice(8,-1))this.type=2;else{var e=this.imgs,a=this.fieldName;this.type=1,t=[r()({},a,e)]}return t}},methods:l()({},Object(m.b)(["token"]),{checkout:function(t){var e=this;return new n.a(function(a,i){if(e.imgSize){var n=e.imgSize,o=new FileReader;o.onload=function(t){var e=new Image;e.onload=function(){var t=e.width,o=e.height;n!==t+"*"+o?i("请上传正确尺寸"+n+"的图片"):a()},e.src=t.target.result},o.readAsDataURL(t)}else a()})},fileChange:function(t,e){var a=this,i=t.target.files[0];if(!i||-1===this.uploadType.indexOf(i.type.split("/").pop()))return this.$message({message:"格式错误，仅支持"+this.uploadType.join(",")+"格式的文件",type:"error",duration:1800}),!1;var n=i.type.split("/").pop();this.checkout(i).then(function(){var t={target:".uploadNum"+a.number+e,background:"white",customClass:"imgMask"},o=d.Loading.service(t),l=new FormData;l.append("file",i);var s=a.token(),r={headers:{token:s||"palace_yanxi"}},c=-1===["mp3"].indexOf(n)?"https://luna.ajimiyou.com/luna/image/uploadPic":"https://luna.ajimiyou.com/luna/video/upload";u.a.post(c,l,r).then(function(t){console.log("响应结果",t.data);var i=t.data.data,n=i;2===a.type&&(a.imgs[e][a.fieldName]=i,n=a.imgs),a.$emit("cc",n),o.close()}).catch(function(t){console.log("错误结果",t),a.$message({message:"出错了！*>﹏<* ~ 请重新上传",type:"error",duration:1800}),o.close()})}).catch(function(t){a.$message({message:t,type:"error",duration:1800})})},handleDelete:function(t){var e="";2===this.type&&(this.imgs[t][this.fieldName]="",e=this.imgs),this.$emit("cc",e)}})},f=(a("ki4V"),a("KHd+")),g=Object(f.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"imageLoad clearfix"},t._l(t.imgNum,function(e,i){return a("div",{key:i,staticClass:"load-inner",style:{width:t.imgWidth+"px",height:t.imgHeight+"px"}},[null==t.images[i][t.fieldName]||""==t.images[i][t.fieldName]?[a("div",{class:"uploadNum"+t.number+i,style:{height:t.imgHeight+"px"}},[a("i",{staticClass:"load-icon el-icon-plus"}),t._v(" "),a("input",{staticClass:"load-file",attrs:{type:"file",name:"image"},on:{change:function(e){t.fileChange(e,i)}}})])]:[a("div",{staticClass:"load-img"},[a("label",{staticClass:"delete-label"},[a("i",{staticClass:"delete el-icon-close",on:{click:function(e){t.handleDelete(i)}}})]),t._v(" "),"mp3"===t.images[i][t.fieldName].split(".").pop()?[a("audio",{attrs:{preload:"auto",controls:"",src:t.images[i][t.fieldName]}},[t._v("\n            您的浏览器不支持audio播放器，请更换或升级浏览器\n          ")])]:[a("img",{attrs:{src:t.images[i][t.fieldName],alt:"暂无图片"}})]],2)]],2)}))},[],!1,null,"ffb09534",null);g.options.__file="new.vue";e.a=g.exports},"96ms":function(t,e,a){},"9Pcu":function(t,e,a){"use strict";var i={props:{thead:{type:Array,required:!0},list:{type:Array,required:!0,default:function(){return[]}},actions:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1}},computed:{},created:function(){},methods:{}},n=(a("SG8p"),a("KHd+")),o=Object(n.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"border-radius":"6px","margin-top":"15px"},attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[t._l(t.thead,function(e){return a("el-table-column",{key:e.label,attrs:{sortable:e.sort,label:e.label,width:e.width,prop:e.value,align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e.isImage?["Array"==={}.toString.call(i.row[e.value]).slice(8,-1)?a("el-carousel",{attrs:{height:e.styleObject.height,autoplay:!1,"indicator-position":"none",type:"card"}},t._l(i.row[e.value],function(t,i){return a("el-carousel-item",{key:i},[a("img",{style:e.styleObject,attrs:{src:t,alt:"暂无图片"}})])})):a("img",{style:e.styleObject,attrs:{src:i.row[e.value],alt:"暂无图片"}})]:e.isTag?t._l(i.row[e.value],function(e,i){return a("span",{key:i,staticClass:"el-tag el-tag--info el-tag--small",staticStyle:{margin:"4px"}},[a("span",{staticClass:"el-select__tags-text"},[t._v("\n            "+t._s(e)+"\n          ")])])}):[t._v("\n        "+t._s(i.row[e.value])+"\n      ")]]}}])})}),t._v(" "),0!==t.list.length&&0!==t.actions.length?a("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.actions,function(i,n){return a("el-button",{key:i.value,style:{margin:t.actions.length>2?"5px":"0 0 0 10px"},attrs:{type:i.type,size:"mini"},on:{click:function(t){i.click(e.row,e.$index)}}},[t._v(t._s(i.value)+"\n      ")])})}}])}):t._e()],2)},[],!1,null,"5215e21c",null);o.options.__file="index.vue";e.a=o.exports},AkCo:function(t,e,a){"use strict";a.r(e);var i=a("FyfS"),n=a.n(i),o=a("P2sY"),l=a.n(o),s=a("XJYT"),r=a("9Pcu"),c=a("+HKF"),u=a("t3Un");var d={components:{Table:r.a,Dropzone:c.a},data:function(){return{list:[],listLoading:!0,options:{target:"#holylandDialog",lock:!0,text:"拼命加载中"},loaded:null,total:0,thead:[],roleAry:[],listQuery:{index:1,pageSize:10,orderType:0,keyword:""},actions:[{type:"danger",value:"删除",click:this.handleDelete}],temp:{cartoonName:"",cartoonImage:"",photoName:"",photoImage:""},dialogStatus:"",dialogFormVisible:!1,rules:{cartoonName:[{type:"string",required:!0,message:"动漫名称是必须的",trigger:"blur"}],photoName:[{type:"string",required:!0,message:"拍摄地点是必须的",trigger:"blur"}]}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;this.listLoading=!0,function(t){return Object(u.a)({url:"/tour/list",method:"get",params:t})}(this.listQuery).then(function(e){console.log(e);var a=e.data,i=a.items,n=a.totalCount,o=i;t.getHead(o),t.list=o,t.total=parseInt(n),t.listLoading=!1})},getHead:function(t){var e=[];for(var a in t[0]){var i={sort:!1};switch(a){case"id":i.label="id",i.sort=!0,i.value=a,e[0]=i;break;case"cartoonName":i.label="动漫名称",i.value=a,e[1]=i;break;case"cartoonImage":i.label="动漫配图",i.value=a,i.isImage=!0,i.styleObject={width:"70px",height:"70px"},e[2]=i;break;case"photoName":i.label="拍摄地点",i.value=a,e[3]=i;break;case"photoImage":i.label="拍摄图片",i.value=a,i.isImage=!0,i.styleObject={width:"70px",height:"70px"},e[4]=i;break;default:continue}}this.thead=e},handleCurrentChange:function(t){this.listQuery.index=t,this.fetchData()},handleFilter:function(){this.listQuery.index=1,this.fetchData()},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="添加",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleUpdate:function(t){var e=this;console.log(t),this.temp=l()({},t),this.dialogStatus="编辑",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleDelete:function(t){var e=this;console.log("删除权限",t),function(t){return Object(u.a)({url:"/tour/tours/"+t.id,method:"delete"})}({id:t.id}).then(function(){var a=e.list.indexOf(t);e.list.splice(a,1),e.total=e.total-1,e.$notify({title:"成功",message:"用户删除成功",type:"success",duration:1500})})},resetTemp:function(){this.temp={cartoonName:"",cartoonImage:"",photoName:"",photoImage:""}},checkout:function(){return""!==this.temp.cartoonImage&&""!==this.temp.photoImage||(this.$message({message:"请上传图片",duration:1500,type:"error"}),!1)},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e&&t.checkout()){t.loaded=s.Loading.service(t.options);var a=l()({},t.temp);console.log("createData",a),function(t){return Object(u.a)({url:"/tour/import",method:"post",data:t})}(a).then(function(e){var a=e.data;t.list.unshift(a),1===t.list.length&&t.getHead(t.list),t.total=t.total+1,t.dialogFormVisible=!1,t.$notify({title:"成功",message:"上传成功",type:"success",duration:1e3,onClose:function(){t.loaded.close()}})})}})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=l()({},t.temp);updateAccess(a).then(function(e){var a=t.dealData([e.data])[0],i=!0,o=!1,l=void 0;try{for(var s,r=n()(t.list);!(i=(s=r.next()).done);i=!0){var c=s.value;if(c.id===a.id){var u=t.list.indexOf(c);t.list.splice(u,1,a);break}}}catch(t){o=!0,l=t}finally{try{!i&&r.return&&r.return()}finally{if(o)throw l}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:1500})})}})}}},m=(a("akT3"),a("KHd+")),p=Object(m.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inner"},[a("span",{staticClass:"title"},[t._v("分享文案配置")]),t._v(" "),a("div",{staticClass:"app-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"400px","margin-right":"20px"},attrs:{placeholder:"请输入要搜索的uid"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",t._n(e))},expression:"listQuery.keyword"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加文案")]),t._v(" "),a("Table",{attrs:{thead:t.thead,list:t.list||[],listLoading:t.listLoading,actions:t.actions}}),t._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper",total:t.total,"current-page":t.listQuery.index,"page-size":t.listQuery.pageSize},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"dialog",attrs:{id:"holylandDialog"}},[a("el-form",{ref:"dataForm",attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"90px"}},[a("div",{staticClass:"content"},[a("el-form-item",{staticClass:"imgName",attrs:{label:"动漫名称",prop:"cartoonName"}},[a("el-input",{attrs:{placeholder:"记录这一刻，输入所属动漫名"},model:{value:t.temp.cartoonName,callback:function(e){t.$set(t.temp,"cartoonName","string"==typeof e?e.trim():e)},expression:"temp.cartoonName"}})],1),t._v(" "),a("el-form-item",{staticClass:"img",attrs:{label:"动漫区域"}},[a("Dropzone",{attrs:{number:0,imgWidth:300,imgHeight:150},model:{value:t.temp.cartoonImage,callback:function(e){t.$set(t.temp,"cartoonImage",e)},expression:"temp.cartoonImage"}})],1)],1),t._v(" "),a("div",{staticClass:"content"},[a("el-form-item",{staticClass:"imgName",attrs:{label:"拍摄地点",prop:"photoName"}},[a("el-input",{attrs:{placeholder:"记录这一刻，输入拍摄地"},model:{value:t.temp.photoName,callback:function(e){t.$set(t.temp,"photoName","string"==typeof e?e.trim():e)},expression:"temp.photoName"}})],1),t._v(" "),a("el-form-item",{staticClass:"img",attrs:{label:"实景区域"}},[a("Dropzone",{attrs:{number:1,imgWidth:300,imgHeight:150},model:{value:t.temp.photoImage,callback:function(e){t.$set(t.temp,"photoImage",e)},expression:"temp.photoImage"}})],1)],1)]),t._v(" "),a("div",{staticClass:"dialog-footer clearfix",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!t.dialogFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:function(e){t.createData()}}},[t._v("添加")])],1)],1)])],1)])},[],!1,null,"6faf939c",null);p.options.__file="holyland.vue";e.default=p.exports},FyfS:function(t,e,a){t.exports={default:a("Rp86"),__esModule:!0}},"RU/L":function(t,e,a){a("Rqdy");var i=a("WEpk").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},Rp86:function(t,e,a){a("bBy9"),a("FlQf"),t.exports=a("fXsU")},Rqdy:function(t,e,a){var i=a("Y7ZC");i(i.S+i.F*!a("jmDH"),"Object",{defineProperty:a("2faE").f})},SEkw:function(t,e,a){t.exports={default:a("RU/L"),__esModule:!0}},SG8p:function(t,e,a){"use strict";var i=a("TqJv");a.n(i).a},TqJv:function(t,e,a){},YEIV:function(t,e,a){"use strict";e.__esModule=!0;var i=function(t){return t&&t.__esModule?t:{default:t}}(a("SEkw"));e.default=function(t,e,a){return e in t?(0,i.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},akT3:function(t,e,a){"use strict";var i=a("vyHN");a.n(i).a},fXsU:function(t,e,a){var i=a("5K7Z"),n=a("fNZA");t.exports=a("WEpk").getIterator=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}},ki4V:function(t,e,a){"use strict";var i=a("96ms");a.n(i).a},vyHN:function(t,e,a){}}]);