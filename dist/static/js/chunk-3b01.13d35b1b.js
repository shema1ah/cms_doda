(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3b01"],{"9Pcu":function(t,e,a){"use strict";var n={props:{thead:{type:Array,required:!0},list:{type:Array,required:!0,default:function(){return[]}},actions:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1}},computed:{},created:function(){},methods:{}},i=(a("SG8p"),a("KHd+")),l=Object(i.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{"border-radius":"6px","margin-top":"15px"},attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[t._l(t.thead,function(e){return a("el-table-column",{key:e.label,attrs:{sortable:e.sort,label:e.label,width:e.width,prop:e.value,align:"center"},scopedSlots:t._u([{key:"default",fn:function(n){return[e.isImage?["Array"==={}.toString.call(n.row[e.value]).slice(8,-1)?a("el-carousel",{attrs:{height:e.styleObject.height,autoplay:!1,"indicator-position":"none",type:"card"}},t._l(n.row[e.value],function(t,n){return a("el-carousel-item",{key:n},[a("img",{style:e.styleObject,attrs:{src:t,alt:"暂无图片"}})])})):a("img",{style:e.styleObject,attrs:{src:n.row[e.value],alt:"暂无图片"}})]:e.isTag?t._l(n.row[e.value],function(e,n){return a("span",{key:n,staticClass:"el-tag el-tag--info el-tag--small",staticStyle:{margin:"4px"}},[a("span",{staticClass:"el-select__tags-text"},[t._v("\n            "+t._s(e)+"\n          ")])])}):[t._v("\n        "+t._s(n.row[e.value])+"\n      ")]]}}])})}),t._v(" "),0!==t.list.length&&0!==t.actions.length?a("el-table-column",{attrs:{label:"操作",align:"center",width:"160","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(t.actions,function(n,i){return a("el-button",{key:n.value,style:{margin:t.actions.length>2?"5px":"0 0 0 10px"},attrs:{type:n.type,size:"mini"},on:{click:function(t){n.click(e.row,e.$index)}}},[t._v(t._s(n.value)+"\n      ")])})}}])}):t._e()],2)},[],!1,null,"5215e21c",null);l.options.__file="index.vue";e.a=l.exports},"9TBs":function(t,e,a){"use strict";var n=a("VT79");a.n(n).a},FyfS:function(t,e,a){t.exports={default:a("Rp86"),__esModule:!0}},Rp86:function(t,e,a){a("bBy9"),a("FlQf"),t.exports=a("fXsU")},SG8p:function(t,e,a){"use strict";var n=a("TqJv");a.n(n).a},TqJv:function(t,e,a){},VT79:function(t,e,a){},bDWH:function(t,e,a){"use strict";a.r(e);var n=a("FyfS"),i=a.n(n),l=a("P2sY"),s=a.n(l),r=a("QbLZ"),o=a.n(r),c=a("9Pcu"),u=a("iYj1"),d=a("rEr0"),f={components:{Table:c.a},data:function(){return{list:[],listLoading:!0,total:0,thead:[],listQuery:{index:1,pageSize:10,keyword:""},actions:[{type:"primary",value:"编辑",click:this.handleUpdate},{type:"danger",value:"删除",click:this.handleDelete}],temp:{},checkAll:!1,allRoutes:[],allRoutesId:[],dialogStatus:"",dialogFormVisible:!1,rules:{name:[{type:"string",required:!0,message:"角色名称是必须的",trigger:"blur"}]}}},created:function(){this.fetchData(),this.fetchRoutesData()},methods:{dealData:function(t,e){if(e){var a=t,n=a.id,i=a.name,l=a.zy_menusId,s=this.allRoutes.filter(function(t){return l.indexOf(t.id)>-1});return n?{id:n,name:i,menus:s}:{name:i,menus:s}}return(t=t||[]).forEach(function(t){var e=[],a=[];t.menus.forEach(function(t){e.push(t.name),a.push(t.id)}),t.zy_menus=e,t.zy_menusId=a}),t},fetchData:function(){var t=this;this.listLoading=!0,Object(u.c)(this.listQuery).then(function(e){var a=e.data,n=a.items,i=a.totalCount,l=t.dealData(n);console.log(l),t.getHead(l),t.list=l,t.total=parseInt(i),t.listLoading=!1})},fetchRoutesData:function(){var t=this;Object(d.c)(o()({},this.listQuery,{pageSize:30})).then(function(e){console.log(e);var a=e.data,n=a.items,i=(a.totalCount,[]);(n=n||[]).forEach(function(t){i.push(t.id)}),t.allRoutes=n,t.allRoutesId=i})},getHead:function(t){var e=[];for(var a in t[0]){var n={sort:!1};switch(a){case"id":n.label="id",n.width="120",n.sort=!0,n.value=a,e[0]=n;break;case"name":n.label="角色名称",n.width="220",n.value=a,e[1]=n;break;case"zy_menus":n.label="拥有权限",n.value=a,n.isTag=!0,e[2]=n;break;default:continue}}this.thead=e},handleCurrentChange:function(t){this.listQuery.index=t,this.fetchData()},handleFilter:function(){this.listQuery.index=1,this.fetchData()},handleCheckAll:function(t){this.temp.zy_menusId=t?this.allRoutesId:[]},handleCheckChange:function(t){this.checkAll=t.length===this.allRoutesId.length},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="添加",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleUpdate:function(t){var e=this;console.log(t),this.checkAll=t.menus.length===this.allRoutes.length,this.temp=s()({},t),this.dialogStatus="编辑",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleDelete:function(t){var e=this;console.log("删除角色",t),Object(u.b)({id:t.id}).then(function(){var a=e.list.indexOf(t);e.list.splice(a,1),e.total=e.total-1,e.$notify({title:"成功",message:"角色删除成功",type:"success",duration:1500})})},resetTemp:function(){this.checkAll=!1,this.temp={name:"",menus:[],zy_menusId:[]}},createData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=s()({},t.temp);a=t.dealData(a,1),console.log("createData",a),Object(u.a)(a).then(function(e){var a=t.dealData([e.data])[0];t.list.unshift(a),1===t.list.length&&t.getHead(t.list),t.total=t.total+1,t.dialogFormVisible=!1,t.$notify({title:"成功",message:"创建成功",type:"success",duration:1500})})}})},updateData:function(){var t=this;this.$refs.dataForm.validate(function(e){if(e){var a=s()({},t.temp);a=t.dealData(a,1),console.log("updateData",a),Object(u.d)(a).then(function(e){var a=t.dealData([e.data])[0];console.log(a);var n=!0,l=!1,s=void 0;try{for(var r,o=i()(t.list);!(n=(r=o.next()).done);n=!0){var c=r.value;if(c.id===a.id){var u=t.list.indexOf(c);t.list.splice(u,1,a);break}}}catch(t){l=!0,s=t}finally{try{!n&&o.return&&o.return()}finally{if(l)throw s}}t.dialogFormVisible=!1,t.$notify({title:"成功",message:"更新成功",type:"success",duration:1500})})}})}}},h=(a("9TBs"),a("KHd+")),p=Object(h.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inner"},[a("span",{staticClass:"title"},[t._v("角色管理")]),t._v(" "),a("div",{staticClass:"app-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"400px","margin-right":"20px"},attrs:{placeholder:"请输入要搜索的内容"},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleFilter(e):null}},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",t._n(e))},expression:"listQuery.keyword"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("搜索")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"success",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("新增数据")]),t._v(" "),a("Table",{attrs:{thead:t.thead,list:t.list||[],listLoading:t.listLoading,actions:t.actions}}),t._v(" "),a("div",{staticClass:"pagination-container",staticStyle:{"margin-top":"20px"},attrs:{align:"right"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper",total:t.total,"current-page":t.listQuery.index,"page-size":t.listQuery.pageSize},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),a("el-dialog",{attrs:{title:t.dialogStatus,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"dialog"},[a("el-form",{ref:"dataForm",staticStyle:{"min-width":"450px","max-width":"1000px"},attrs:{rules:t.rules,model:t.temp,"label-position":"right","label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"name"}},[a("el-input",{staticStyle:{"max-width":"350px"},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name","string"==typeof e?e.trim():e)},expression:"temp.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"拥有的权限"}},[a("el-checkbox",{on:{change:t.handleCheckAll},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),t._v(" "),a("el-checkbox-group",{on:{change:t.handleCheckChange},model:{value:t.temp.zy_menusId,callback:function(e){t.$set(t.temp,"zy_menusId",e)},expression:"temp.zy_menusId"}},t._l(t.allRoutes,function(e){return a("el-checkbox",{key:e.id,staticStyle:{margin:"0 20px 0 0"},attrs:{label:e.id}},[t._v(t._s(e.name))])}))],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer clearfix",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisible=!t.dialogFormVisible}}},[t._v("取消")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:function(e){"编辑"===t.dialogStatus?t.updateData():t.createData()}}},[t._v(t._s("编辑"==t.dialogStatus?"保存":"添加"))])],1)],1)])],1)])},[],!1,null,null,null);p.options.__file="index.vue";e.default=p.exports},fXsU:function(t,e,a){var n=a("5K7Z"),i=a("fNZA");t.exports=a("WEpk").getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},iYj1:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return l}),a.d(e,"d",function(){return s}),a.d(e,"b",function(){return r});var n=a("t3Un");function i(t){return Object(n.a)({url:"/role/list",method:"post",data:t})}function l(t){return Object(n.a)({url:"/role/add",method:"post",data:t})}function s(t){return Object(n.a)({url:"/role/update",method:"post",data:t})}function r(t){return Object(n.a)({url:"/role/delete",method:"post",data:t})}},rEr0:function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"a",function(){return l}),a.d(e,"d",function(){return s}),a.d(e,"b",function(){return r});var n=a("t3Un");function i(t){return Object(n.a)({url:"/systemMenu/listAll",method:"post",data:t})}function l(t){return Object(n.a)({url:"/systemMenu/add",method:"post",data:t})}function s(t){return Object(n.a)({url:"/systemMenu/update",method:"post",data:t})}function r(t){return Object(n.a)({url:"/systemMenu/delete",method:"post",data:t})}}}]);